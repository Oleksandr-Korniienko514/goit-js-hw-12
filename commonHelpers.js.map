{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '45213588-1347783919d0c1f7f1631233d';\nconst STATUS_BAD_REQUEST = 400;\n\nexport async function getImages(query, page) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: page,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params: params });\n\n   \n    if (response.data && Array.isArray(response.data.hits)) {\n      return response.data;\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message: 'Unexpected API response format.',\n        position: 'topRight',\n      });\n      return { hits: [] };  \n    }\n  } catch (error) {\n   \n    iziToast.error({\n      title: 'Request error',\n      message: `Something went wrong: ${error.message}`,\n      position: 'topRight',\n    });\n\n    \n    return { hits: [] };\n  }\n}\n","const gallery = document.querySelector('.gallery');\n\nfunction imgTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-card\"> \n    <figure class=\"image-container\">\n      <a href=\"${largeImageURL}\">\n        <img class=\"image-thumbnail\" src=\"${webformatURL}\" alt=\"${tags}\" title=\"\" width=\"360\" height=\"200\"/>\n      </a>\n      <figcaption class=\"image-details\">\n        <ul class=\"details-list\">\n          <li class=\"details-item\">Likes<p class=\"details-count\">${likes}</p></li>\n          <li class=\"details-item\">Views<p class=\"details-count\">${views}</p></li>\n          <li class=\"details-item\">Comments<p class=\"details-count\">${comments}</p></li>\n          <li class=\"details-item\">Downloads<p class=\"details-count\">${downloads}</p></li>\n        </ul>\n      </figcaption>\n    </figure>\n  </li>`;\n}\n\n\nfunction imgsTemplate(arr) {\n  return arr.map(imgTemplate).join('');\n}\n\nexport function renderImg(hits) {\n  const markup = imgsTemplate(hits);\n  gallery.innerHTML += markup;\n}","import { getImages } from './js/pixabay-api';\nimport { renderImg } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  btnSearch: document.querySelector('.btn-search'),\n  form: document.querySelector('.form'),\n  input: document.querySelector('input'),\n  ul: document.querySelector('ul.gallery'),\n  loadBtn: document.querySelector('.load-btn'),\n};\n\nlet page = 1;\nlet query = '';\nlet gallery = new SimpleLightbox('.gallery a');\nlet totalHits = 0; \nlet loadedImages = 0; \n\nrefs.loadBtn.classList.add('hiddenBtn');\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = refs.input.value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query',\n    });\n    refs.loadBtn.classList.add('hiddenBtn');\n    return;\n  }\n\n  refs.ul.innerHTML = '';\n  page = 1;\n  totalHits = 0;\n  loadedImages = 0;\n  startLoader();\n\n  try {\n    const result = await getImages(query, page);\n    stopLoader();\n\n    if (result.hits.length === 0) {\n      iziToast.error({\n        title: 'No results',\n        message: 'No images found. Please try a different query.',\n      });\n      refs.loadBtn.classList.add('hiddenBtn');\n    } else {\n      totalHits = result.totalHits; \n      loadedImages += result.hits.length; \n      renderImg(result.hits);\n      gallery.refresh();\n\n      if (loadedImages >= totalHits) {\n        refs.loadBtn.classList.add('hiddenBtn');\n      } else {\n        refs.loadBtn.classList.remove('hiddenBtn');\n      }\n    }\n  } catch (error) {\n    stopLoader();\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong.',\n    });\n    refs.loadBtn.classList.add('hiddenBtn');\n  }\n});\n\nrefs.loadBtn.addEventListener('click', async () => {\n  page += 1;\n  console.log('Page incremented:', page);\n  startLoader();\n\n  try {\n    const result = await getImages(query, page);\n    stopLoader();\n\n    if (result.hits.length === 0) {\n      iziToast.info({\n        title: 'No more results',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      refs.loadBtn.classList.add('hiddenBtn');\n    } else {\n      loadedImages += result.hits.length;\n      renderImg(result.hits);\n      gallery.refresh();\n\n      if (loadedImages >= totalHits) {\n        refs.loadBtn.classList.add('hiddenBtn');\n        iziToast.info({\n          title: 'No more results',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    }\n\n    scrollToEnd();\n  } catch (error) {\n    stopLoader();\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong.',\n    });\n    refs.loadBtn.classList.add('hiddenBtn');\n  }\n});\n\nfunction scrollToEnd() {\n  window.scrollTo({\n    top: document.body.scrollHeight,\n    behavior: 'smooth',\n  });\n}\n\nfunction startLoader() {\n  refs.loadBtn.classList.add('hiddenBtn');\n  refs.loadBtn.insertAdjacentHTML(\n    'afterend',\n    '<div id=\"loader\" class=\"loader\"></div>'\n  );\n}\n\nfunction stopLoader() {\n  const loader = document.querySelector('.loader');\n  if (loader) loader.remove();\n\n \n  if (loadedImages < totalHits) {\n    refs.loadBtn.classList.remove('hiddenBtn');\n  }\n}\n"],"names":["BASE_URL","API_KEY","getImages","query","page","params","response","axios","iziToast","error","gallery","imgTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgsTemplate","arr","renderImg","hits","markup","refs","SimpleLightbox","totalHits","loadedImages","startLoader","result","stopLoader","scrollToEnd","loader"],"mappings":"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"}